{% extends 'tweet_display/application.html' %}

{% block content %}

<div class="row">
  <div class="col-md-8">
    <div class='overall_tweets'></div>
  </div>
  <div class="col-md-4">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Tweets per day</h3>
      </div>
      <div class="panel-body">
        <p>
          The amount we tweet per day can change over time. This data can be
          really noisy: On some days we might hammer out one tweet after the other,
          while on other days we don't get around to doing much tweeting at all.
          There might be vacations, days where you're sick in bed etc. This can make
          it very hard to see long-term trends.
        </p>
        <p>
          For this reason the data here was
          averaged to remove the noise. This was done by applying a rolling average
          on a 180 day window. This should make it much easier to see how one's
          behaviour changed over larger time-frames (In <code>pandas</code> this
          rolling average is created by
          <code>
            dataframe.rolling('180d').mean()
          </code>).
        </p>
        <p>
          In our graph to the left the <code>x-axis</code> gives us the time since
          one signed up for <i>Twitter</i> and the <code>y-axis</code> gives the
          normalized number of tweets on a given day.
        </p>
      </div>
    </div>
  </div>
</div>

<div class='tweet_types'></div>
<div class='hourly_tweets'></div>

<script>
  d3.json('{% url 'hourly_tweets' %}', function(hdata) {
    MG.data_graphic({
      title: "Tweets per Hour",
      description: "How much do you tweet per hour?",
      data: hdata,
      width: 600,
      height: 450,
      top: 50,
      right: 60,
      full_width: true,
      target: ".hourly_tweets",
      x_accessor: "hour",
      y_accessor: [ 'Weekday', 'Weekend'],
      legend: [ 'Weekday',
              'Weekend'],
              aggregate_rollover: true,
              x_label : 'hour',
              xax_count : 24,
              y_extended_ticks: true
      });
  });

  d3.json('{% url 'tweet_types' %}', function(data) {
     data = MG.convert.date(data, 'date');
     MG.data_graphic({
       title: "Tweet classifications",
       description: "Percent of your tweets in a given window that are replies, retweets or regular tweets",
       data: data,
       width: 600,
       height: 450,
       right: 100,
       full_width: true,
       target: ".tweet_types",
       x_accessor: "date",
       y_accessor: ["p_rt",'p_reply','p_other'],
       legend: ["retweets",'replies','regular tweets'],
       aggregate_rollover: true,
       x_label: 'Date',
       y_extended_ticks: true,
       yax_units: '%',
       yax_units_append: true,
       markers: [{'date': new Date('2009-11-06T00:00:00.000Z'), 'label': 'Twitter "invents" retweets'}],
     })
  });

  d3.json('{% url 'overall_tweets' %}', function(data) {
     data = MG.convert.date(data, 'date');
     MG.data_graphic({
       title: "Tweets per day",
       description: "How much you tweeted per day",
       data: data,
       width: 600,
       height: 450,
       right: 60,
       full_width: true,
       area: false,
       target: ".overall_tweets",
       x_accessor: "date",
       y_accessor: "tweets",
     });
  });
  </script>

{% endblock %}
